# 传输层

单工：单向传输，比如电视、广播。都是只能单向传输给你，你没法回复电视吧。
半双工：可以双向传输，但是在同一个时间点内，只能单向通信。比如对讲机。
全双工：可以在任意时间点同时双向传输，双向通信。比如电话

1. 位于应用层和网络层之间
2. 是面向连接的、可靠的进程到进程通信的协议
3. TCP将提供双全工服务，即数据可在同一时间双向传播
4. TCP将若干个字节称为一个分组，此分组称为一个报文段(Segment)，也就是说数据在TCP层称做报文段
5. 对可靠性要求高的上层协议，实现可靠性的保证，如果数据丢失、损坏的情况下如何保证可靠性。网络层只管传递数据，成功与否并不关心。

## 传输层的功能

传输层是只有主机才有的层次，中间的网路设备，最多只有三层，只能到网络层。
传输层是为应用层提供通信服务，同时它可以使用网络层的服务。
1. **传输层提供进程和进程之间的逻辑通信。**
我们知道在网络层是实现主机之间的通信(主机与主机之间的逻辑通信)，信息传输到主机即可。但是实际上这并没有通信完全，比如QQ之间进行对话，不能只是传递到对方主机，还需要传递到对方主机的QQ进程上，实现源主机的QQ进程和目标主机的QQ进程之间的通信才算一个完整的通信。

2. **复用和分用**
复用是指发送方不同的应用进程都可以使用同一个传输层传输数据。比如QQ和微信都可以使用同一个传输层协议来进行发送数据。<br/>
分用是指接收方的传输层在剥去报文的首部后能够把这些数据正确交付到目的应用进程。是指传输层接收到的是多个进程的数据，比如QQ和微信的，因此需要分别交付给QQ和微信来进行处理，也就是分开处理。

3. **传输层对收到的报文进行差错检测**
在网络层只对报文首部数据进行首部数据和校验，不会对传输数据进行校验，而传输层需要对数据进行检测，这样的话才能够实现对整个数据的校验，确保数据的不出错。
4. **传输层的两个协议：TCP和UDP**
纯属层有两个好兄弟，大哥TCP和二弟UDP，大哥靠谱，二弟不靠谱。
TCP:传送数据之前必须建立连接，数据传送结束之后要释放连接。不提供广播或者多播服务。由于TCP要提供可靠的面向连接的传输服务，因此不可避免地增加了许多开销：回复确认、流程控制、计时器以及连接管理等。**可靠，面向连接，时延大，适用于大文件**<br>
UDP:传送数据之前不需要建立连接，收到UDP报文后也不需要给出任何确认。**不可靠，无连接，时延小，适用于小文件**


### 传输层的寻址和端口
复用：应用层所有的应用进程都可以通过传输层再传输到网络层。
分用：传输层从网络层收到数据后交付指明的应用进程。
#### 端口

那么它是如何找到指明的应用进程。我们知道在网络层是通过IP找到对应的网络，再通过物理地址MAC地址找到对应的主机。
而在传输层也是一样的，通过**端口**来指明找到对应的应用进程。
端口是传输层的SAP，标识主机中的应用进程。每个端口通过一个数字即端口号来进行标识，端口号只有本地意义，在因特网中不同计算机的相同端口号是没有联系的。

端口号长度为16bit，能表示65536个不同的端口号。
![端口号分类](https://ftp.bmp.ovh/imgs/2021/02/01655e47cde73d61.jpg)

#### 套接字socket
在网络中采用发送方和接收方的套接字组合来识别端点，套接字唯一标识了网络中的一个主机和它上面的一个进程。
套接字Socket = (主机IP地址，端口号)

